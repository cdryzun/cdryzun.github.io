<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
<title>Jira &amp; confluence 安装 并 配置 破解激活 - 「Johny'」PlayGround</title>
<meta content="webkit" name="renderer"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport"/>
<meta content="no-transform" http-equiv="Cache-Control"/>
<meta content="no-siteapp" http-equiv="Cache-Control"/>
<meta content="#f8f5ec" name="theme-color"/>
<meta content="#f8f5ec" name="msapplication-navbutton-color"/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="#f8f5ec" name="apple-mobile-web-app-status-bar-style"/>
<meta content="Johny" name="author"/><meta content="jira 8.x 和 confluence 安装破解并激活。" name="description"/><meta content="jira, 安装, 破解, 破解安装, install, confluence, 8.x" name="keywords"/>
<meta content="Hugo 0.92.0 with theme even" name="generator"/>
<link href="https://cdryzun.github.io/post/jira-install/" rel="canonical"/>
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"/>
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/>
<link href="/manifest.json" rel="manifest"/>
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon"/>
<link href="/sass/main.min.404b35997075abed13fc31198c48ccfa115c0855fc6e525128eac767d84fdcd2.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="https://cdn.treesir.pub/blog-css/jquery.fancybox.min.css" rel="stylesheet"/>
<link href="/css/custom.css" rel="stylesheet"/>
<meta content="Jira &amp; confluence 安装 并 配置 破解激活" property="og:title"/>
<meta content="jira 8.x 和 confluence 安装破解并激活。" property="og:description"/>
<meta content="article" property="og:type"/>
<meta content="https://cdryzun.github.io/post/jira-install/" property="og:url"/><meta content="post" property="article:section"/>
<meta content="2021-02-21T11:02:00+08:00" property="article:published_time"/>
<meta content="2021-02-21T11:02:00+08:00" property="article:modified_time"/>
<meta content="Jira &amp; confluence 安装 并 配置 破解激活" itemprop="name"/>
<meta content="jira 8.x 和 confluence 安装破解并激活。" itemprop="description"/><meta content="2021-02-21T11:02:00+08:00" itemprop="datePublished"/>
<meta content="2021-02-21T11:02:00+08:00" itemprop="dateModified"/>
<meta content="1260" itemprop="wordCount"/>
<meta content="jira,install,confluence," itemprop="keywords"/><meta content="summary" name="twitter:card"/>
<meta content="Jira &amp; confluence 安装 并 配置 破解激活" name="twitter:title"/>
<meta content="jira 8.x 和 confluence 安装破解并激活。" name="twitter:description"/>
<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->
<!--[if lt IE 9]>
  <script src="https://cdn.treesir.pub/blog-js/html5shiv.min.js"></script>
  <script src="https://cdn.treesir.pub/blog-js/respond.min.js"></script>
<![endif]-->
<link href="https://cdn.treesir.pub/blog-css/docsearch.min.css" rel="stylesheet"/>
</head>
<body>
<header class="header" id="header">
<div class="logo-wrapper">
<a class="logo" href="/">「Johny'」PlayGround</a>
</div>
<nav class="site-navbar">
<ul class="menu" id="menu">
<li class="menu-item">
<a class="menu-item-link" href="/">主页</a>
</li><li class="menu-item">
<a class="menu-item-link" href="/post/">归档</a>
</li><li class="menu-item">
<a class="menu-item-link" href="/tags/">标签</a>
</li><li class="menu-item">
<a class="menu-item-link" href="/categories/">分类</a>
</li>
</ul><li style="display:inline-block;margin-right:10px;">
<input class="docsearch-input" placeholder="Search" type="search"/>
</li></nav>
</header>
<div class="mobile-navbar" id="mobile-navbar">
<div class="mobile-header-logo">
<a class="logo" href="/">「Johny'」PlayGround</a>
</div>
<div class="mobile-navbar-icon">
<span></span>
<span></span>
<span></span>
</div>
</div>
<nav class="mobile-menu slideout-menu" id="mobile-menu">
<ul class="mobile-menu-list">
<a href="/">
<li class="mobile-menu-item">主页</li>
</a><a href="/post/">
<li class="mobile-menu-item">归档</li>
</a><a href="/tags/">
<li class="mobile-menu-item">标签</li>
</a><a href="/categories/">
<li class="mobile-menu-item">分类</li>
</a>
</ul>
</nav>
<div class="container" id="mobile-panel">
<main class="main" id="main">
<div class="content-wrapper">
<div class="content" id="content">
<article class="post">
<header class="post-header">
<h1 class="post-title">Jira &amp; confluence 安装 并 配置 破解激活</h1>
<div class="post-meta">
<span class="post-time"> 2021-02-21 </span>
<div class="post-category">
<a href="/categories/devops/"> devops </a>
</div>
<span class="more-meta"> 约 1260 字 </span>
<span class="more-meta"> 预计阅读 3 分钟 </span>
</div>
</header>
<div class="post-toc" id="post-toc">
<h2 class="post-toc-title">文章目录</h2>
<div class="post-toc-content always-active">
<nav id="TableOfContents">
<ul>
<li><a href="#环境说明">环境说明</a></li>
<li><a href="#环境初始化">环境初始化</a>
<ul>
<li><a href="#安装-jdk">安装 jdk</a></li>
<li><a href="#安装-mysql-57">安装 mysql 5.7</a>
<ul>
<li><a href="#设置-yum-源">设置 yum 源</a></li>
<li><a href="#yum-安装">yum 安装</a></li>
<li><a href="#启动并设置开机自启动">启动并设置开机自启动</a></li>
<li><a href="#初始化数据库">初始化数据库</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#jira-安装">jira 安装</a>
<ul>
<li><a href="#jira-添加-mysql-jar-包驱动">jira 添加 mysql jar 包驱动</a></li>
<li><a href="#配置-破解补丁">配置 破解补丁</a></li>
<li><a href="#修改配置文件">修改配置文件</a></li>
<li><a href="#dashboard-初始化配置">dashboard 初始化配置</a></li>
<li><a href="#使用工具-获取-license">使用工具 获取 <code>license</code></a></li>
</ul>
</li>
<li><a href="#confluence-安装">confluence 安装</a>
<ul>
<li><a href="#confluence-安装与-jira-安装不同项展示">confluence 安装与 jira 安装不同项展示</a></li>
</ul>
</li>
<li><a href="#问题记录">问题记录</a></li>
<li><a href="#配置-nginx-代理">配置 nginx 代理</a></li>
</ul>
</nav>
</div>
</div>
<div class="post-content">
<h1 id="环境说明">环境说明</h1>
<ul>
<li>操作系统: Centos</li>
<li>安装 Jira  版本:  8.13.4</li>
<li>使用数据库:  Mysql 5.7</li>
<li>jdk 版本:  openjdk 1.8</li>
</ul>
<p><a href="https://www.atlassian.com/zh/software/jira/download">官方 jira 最新版本查看地址</a></p>
<h1 id="环境初始化">环境初始化</h1>
<h2 id="安装-jdk">安装 jdk</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">yum install -y java-1.8.0-openjdk

<span class="o">[</span>root@jira ~<span class="o">]</span><span class="c1"># java -version</span>
openjdk version <span class="s2">"1.8.0_282"</span>
OpenJDK Runtime Environment <span class="o">(</span>build 1.8.0_282-b08<span class="o">)</span>
OpenJDK 64-Bit Server VM <span class="o">(</span>build 25.282-b08, mixed mode<span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="安装-mysql-57">安装 mysql 5.7</h2>
<h3 id="设置-yum-源">设置 yum 源</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">wget https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm

yum localinstall mysql57-community-release-el7-11.noarch.rpm -y

<span class="o">[</span>root@jira ~<span class="o">]</span><span class="c1"># yum repolist enabled | grep "mysql.*-community.*"  # 检查 yum 源是否生效</span>
mysql-connectors-community/x86_64 MySQL Connectors Community                 <span class="m">185</span>
mysql-tools-community/x86_64      MySQL Tools Community                      <span class="m">123</span>
mysql57-community/x86_64          MySQL 5.7 Community Server                 <span class="m">484</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="yum-安装">yum 安装</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">yum install -y mysql-community-server
</code></pre></td></tr></table>
</div>
</div><h3 id="启动并设置开机自启动">启动并设置开机自启动</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">systemctl start mysqld <span class="se">\
</span><span class="se"></span><span class="o">&amp;&amp;</span> systemctl status  mysqld

systemctl <span class="nb">enable</span> mysqld
</code></pre></td></tr></table>
</div>
</div><p><img alt="image-20210221123804575" src="https://cdn.treesir.pub/img/image-20210221123804575.png"/></p>
<h3 id="初始化数据库">初始化数据库</h3>
<p>查看日志文件，获取 mysql <code>root</code> 密码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">grep <span class="s1">'temporary password'</span> /var/log/mysqld.log
2021-02-21T04:37:14.500441Z <span class="m">1</span> <span class="o">[</span>Note<span class="o">]</span> A temporary password is generated <span class="k">for</span> root@localhost: p!o2lkYqNXQu
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>获得密码 <code>p!o2lkYqNXQu</code></p>
</blockquote>
<p>使用获取到的 root 密码初始化数据库</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">mysql -uroot -p  <span class="c1"># 连接数据库</span>


mysql&gt;  ALTER USER <span class="s1">'root'</span>@<span class="s1">'localhost'</span> IDENTIFIED BY <span class="s1">'new password'</span><span class="p">;</span>  <span class="c1"># 设置新密码</span>

mysql&gt; flush privileges<span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p><img alt="image-20210221124608385" src="https://cdn.treesir.pub/img/image-20210221124608385.png"/></p>
<p>创建 jira 所使用 db</p>
<blockquote>
<p><strong>jira 初始化数据库相关 <a href="https://confluence.atlassian.com/adminjiraserver0813/connecting-jira-applications-to-mysql-5-7-1027137456.html"><code>参考文档</code></a></strong></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">mysql&gt; CREATE DATABASE <span class="sb">`</span>jiradb<span class="sb">`</span> CHARACTER SET utf8mb4 COLLATE utf8mb4_bin<span class="p">;</span>  <span class="c1"># 创建 db</span>
</code></pre></td></tr></table>
</div>
</div><p>创建 jira 独立连接用户, 提高安全性。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">mysql&gt; <span class="nb">set</span> global <span class="nv">validate_password_policy</span><span class="o">=</span>0<span class="p">;</span>  <span class="c1"># 临时修改用户密码的安全级别</span>

mysql&gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,REFERENCES,ALTER,INDEX on jiradb.* TO jira_user@<span class="s1">'%'</span> IDENTIFIED BY <span class="s1">'12345678'</span><span class="p">;</span>  <span class="c1"># 新建 用户 及 设置用户密码</span>

mysql&gt; flush privileges<span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p><img alt="image-20210221125446095" src="https://cdn.treesir.pub/img/image-20210221125446095.png"/></p>
<p>mysql 配置文件添加参数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">vi /etc/my.cnf

<span class="o">[</span>mysqld<span class="o">]</span>
default-storage-engine<span class="o">=</span>INNODB
<span class="nv">character_set_server</span><span class="o">=</span>utf8mb4
<span class="nv">innodb_default_row_format</span><span class="o">=</span>DYNAMIC
<span class="nv">innodb_large_prefix</span><span class="o">=</span>ON
<span class="nv">innodb_file_format</span><span class="o">=</span>Barracuda
<span class="nv">innodb_log_file_size</span><span class="o">=</span>2G
<span class="nv">sql_mode</span><span class="o">=</span>NO_AUTO_VALUE_ON_ZERO

service mysqld restart
</code></pre></td></tr></table>
</div>
</div><p><img alt="image-20210221134045070" src="https://cdn.treesir.pub/img/image-20210221134045070.png"/></p>
<h1 id="jira-安装">jira 安装</h1>
<blockquote>
<p>配置完上面的 数据库初始化后，我们就可以进行安装 jira 相关的配置了</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">wget https://cdn.treesir.pub/application/jira/atlassian-jira-software-8.13.4-x64.bin <span class="c1"># 下载软件</span>

chmod a+x atlassian-jira-software-8.13.4-x64.bin  <span class="c1"># 添加可执行权限</span>

./atlassian-jira-software-8.13.4-x64.bin
</code></pre></td></tr></table>
</div>
</div><p><img alt="image-20210221131107289" src="https://cdn.treesir.pub/img/image-20210221131107289.png"/></p>
<p><img alt="image-20210221131128890" src="https://cdn.treesir.pub/img/image-20210221131128890.png"/></p>
<h2 id="jira-添加-mysql-jar-包驱动">jira 添加 mysql jar 包驱动</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">wget https://cdn.treesir.pub/application/jira/mysql-connector-java-5.1.49.tar.gz

tar xf mysql-connector-java-5.1.49.tar.gz

cp  mysql-connector-java-5.1.49/mysql-connector-java-5.1.49-bin.jar /opt/atlassian/jira/atlassian-jira/WEB-INF/lib
</code></pre></td></tr></table>
</div>
</div><h2 id="配置-破解补丁">配置 破解补丁</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">wget https://cdn.treesir.pub/application/jira/atlassian-agent-v1.2.3.zip

yum install unzip -y

unzip atlassian-agent-v1.2.3.zip

mkdir -p /opt/atlassian/jira/jar

cp atlassian-agent-v1.2.3/atlassian-agent.jar  /opt/atlassian/jira/jar/
</code></pre></td></tr></table>
</div>
</div><h2 id="修改配置文件">修改配置文件</h2>
<blockquote>
<p>在 <code>JAVA_OPTS</code> 一行中添加 <code>-javaagent:/opt/atlassian/jira/jar/atlassian-agent.jar</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="nb">cd</span> /opt/atlassian/jira/bin

vim setenv.sh  <span class="c1"># 编辑配置文件</span>
<span class="nv">JAVA_OPTS</span><span class="o">=</span><span class="s2">"-javaagent:/opt/atlassian/jira/jar/atlassian-agent.jar -Xms</span><span class="si">${</span><span class="nv">JVM_MINIMUM_MEMORY</span><span class="si">}</span><span class="s2"> -Xmx</span><span class="si">${</span><span class="nv">JVM_MAXIMUM_MEMORY</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">JVM_CODE_CACHE_ARGS</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">JAVA_OPTS</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">JVM_REQUIRED_ARGS</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">DISABLE_NOTIFICATIONS</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">JVM_SUPPORT_RECOMMENDED_ARGS</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">JVM_EXTRA_ARGS</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">JIRA_HOME_MINUSD</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">START_JIRA_JAVA_OPTS</span><span class="si">}</span><span class="s2">"</span>

service jira stop <span class="se">\
</span><span class="se"></span><span class="o">&amp;&amp;</span> service jira start <span class="c1"># 重启服务</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="dashboard-初始化配置">dashboard 初始化配置</h2>
<p><img alt="image-20210221132221317" src="https://cdn.treesir.pub/img/image-20210221132221317.png"/></p>
<p><img alt="image-20210221134106904" src="https://cdn.treesir.pub/img/image-20210221134106904.png"/></p>
<p><img alt="image-20210221134349334" src="https://cdn.treesir.pub/img/image-20210221134349334.png"/></p>
<blockquote>
<p><strong>记住 server id</strong></p>
</blockquote>
<h2 id="使用工具-获取-license">使用工具 获取 <code>license</code></h2>
<blockquote>
<p><code>复制服务器 id 放至 -s 之后</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="nb">cd</span> /opt/atlassian/jira/jar/

/opt/atlassian/jira/jre/bin/java -jar atlassian-agent.jar -p jira -m aaa@bbb.com -n my_name -o https://zhile.io -s BEVE-RLKR-E429-3JWB

<span class="o">====================================================</span>
<span class="o">=======</span>        Atlassian Crack <span class="nv">Agent</span>         <span class="o">=======</span>
<span class="o">=======</span>           https://zhile.io           <span class="o">=======</span>
<span class="o">=======</span>          QQ Group: <span class="nv">30347511</span>          <span class="o">=======</span>
<span class="o">====================================================</span>

Your license code<span class="o">(</span>Don<span class="err">'</span>t copy this line!!!<span class="o">)</span>: 

AAABfw0ODAoPeJx9klFrwjAUhd/7Kwp7TrVVnAqBzTaDblWHVfc40nrVjDYtN6mb+/WLths6RQiEh
JyT75577+JK2k+Q2J5ru51htzdsd20/ntte23OtDQLIbVGWgE4kUpAK5vsSJjwH6k/HYzbzw8fI8
hG4FoUMuAZ6EJK2R4z8hiQAlaIoDyq6kJnIhYaVndUCO9nbW61LNWy1vrciA0cU1pgLqUFymQL7K
gXum9/6A9K+N8v6EMh/KdlK1NaTKByHcxZYkypPAKfrhQJUlPzB3fAqsVhVqXYOB6KKtf7kCM6F0
Y23PNViB1RjBWdZnt43NS+N24HYs9iOZ9UxT7rmmQJrihsuhaqvLnLxC6mNHzP5ZJRz/pAkiZMWe
c11nfb0/xv4seaoARuMJrAwoFEYxGxCIrfndvr9XqfXdV33LP9rLY8Bd4BGPmJLRmbRy4ywrjcgn
ee30bVJu+zha4Xpliv4P2enYjBDgiUK1ZRnQOkV2Ca1I2O+f5dm/wFMhgkNMCwCFDyreObHK4tWu
NBWoOQpy/gWRwsUAhR9tkejACVL+tc1RzzSopum6rxwfg<span class="o">==</span>X02im
</code></pre></td></tr></table>
</div>
</div><p><img alt="image-20210221134657881" src="https://cdn.treesir.pub/img/image-20210221134657881.png"/></p>
<h1 id="confluence-安装">confluence 安装</h1>
<blockquote>
<p>confluence 安装过程与 jira 安装大致相同 (数据驱动+破解补丁)  如在一台机器上可使用同一个破解补丁，只要保证端口不冲突即可。下面展示与 jira 安装的 <code>不同项</code>。</p>
</blockquote>
<h2 id="confluence-安装与-jira-安装不同项展示">confluence 安装与 jira 安装不同项展示</h2>
<ul>
<li>
<p>安装包 下载</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">wget https://cdn.treesir.pub/application/jira/atlassian-confluence-7.4.1-x64.bin
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>数据库隔离级别</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="c1"># 编辑 my.cnf 添加配置，修改事务提交级别</span>
vi /etc/my.cnf
<span class="o">[</span>mysqld<span class="o">]</span>
transaction-isolation<span class="o">=</span>READ-COMMITTED


mysql&gt;  SET GLOBAL <span class="nv">tx_isolation</span><span class="o">=</span><span class="s1">'READ-COMMITTED'</span><span class="p">;</span>
mysql&gt;  <span class="k">select</span> @@tx_isolation<span class="p">;</span>
mysql&gt;  CREATE DATABASE <span class="sb">`</span>confluence_db<span class="sb">`</span> CHARACTER SET utf8 COLLATE utf8_bin<span class="p">;</span>

cp  mysql-connector-java-5.1.49/mysql-connector-java-5.1.49-bin.jar /opt/atlassian/confluence/confluence/WEB-INF/lib
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>setenv.sh 文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-shell" data-lang="shell"><span class="c1"># javaagent 为破解补丁地址</span>
<span class="nb">export</span> <span class="nv">JAVA_OPTS</span><span class="o">=</span><span class="s2">"-javaagent:/opt/atlassian/jira/jar/atlassian-agent.jar </span><span class="si">${</span><span class="nv">JAVA_OPTS</span><span class="si">}</span><span class="s2">"</span>  <span class="c1">#最上边添加这行配置</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>使用破解补丁获取 license</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-shell" data-lang="shell">/opt/atlassian/confluence/jre/bin/java -jar /opt/atlassian/jira/jar/atlassian-agent.jar -p conf -m aaa@bbb.com -n my_name -o https://zhile.io -s B6RI-Q8HH-ZDR0-FDZ1 <span class="c1"># -s 后接你服务器id </span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h1 id="问题记录">问题记录</h1>
<ul>
<li>
<p>启动权限问题解决</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-shell" data-lang="shell">chown confluence:confluence -R /opt/atlassian/confluence/
sudo chown -R confluence:confluence /opt/atlassian/confluence
sudo chown -R confluence:confluence /home/confluence
sudo chmod -R <span class="nv">u</span><span class="o">=</span>rwx,g<span class="o">=</span>rx,o<span class="o">=</span>rx /opt/atlassian/confluence
sudo chmod -R <span class="nv">u</span><span class="o">=</span>rwx,g<span class="o">=</span>rx,o<span class="o">=</span>rx /home/confluence
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>如安装过程中，需要卸载安装。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-shell" data-lang="shell">/opt/atlassian/confluence/uninstall 
rm -rf /var/atlassian/application-data/confluence

/opt/atlassian/jira/uninstall 
rm -rf /var/atlassian/application-data/jira
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h1 id="配置-nginx-代理">配置 nginx 代理</h1>
<blockquote>
<p>Jira 默认监听在主机中的 <code>8080</code> 端口上, 为了 <code>方便记忆</code> 通常会修改成域名且 <code>不带后面的端口号</code> 的形式进行访问。不带端口号的话，这样就是要使用 <code>80</code> or <code>443</code>端口号了，显然我们这里是内网，不需要什么安全性，只需要使用 80 端口就行。如果让 Jira 监听在 80 端口上的话，显的有些浪费，为了不保证浪费此时我们就可以使用另外一个工具 <code>nginx</code> 配置虚拟机主机来实现反代, 这样就可以同时将 80 端口提供给 <code>多个服务</code>进行使用了。</p>
</blockquote>
<ul>
<li>Jira nginx 配置 <a href="https://confluence.atlassian.com/jirakb/configure-jira-server-to-run-behind-a-nginx-reverse-proxy-426115340.html"><strong>参考文档</strong></a></li>
</ul>
<p><strong>修改 Jira 配置文件</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">vi /opt/atlassian/jira/conf/server.xml

        &lt;Connector <span class="nv">port</span><span class="o">=</span><span class="s2">"8080"</span> <span class="nv">relaxedPathChars</span><span class="o">=</span><span class="s2">"[]|"</span> <span class="nv">relaxedQueryChars</span><span class="o">=</span><span class="s2">"[]|{}^&amp;#x5c;&amp;#x60;&amp;quot;&amp;lt;&amp;gt;"</span>
                   <span class="nv">maxThreads</span><span class="o">=</span><span class="s2">"150"</span> <span class="nv">minSpareThreads</span><span class="o">=</span><span class="s2">"25"</span> <span class="nv">connectionTimeout</span><span class="o">=</span><span class="s2">"20000"</span> <span class="nv">enableLookups</span><span class="o">=</span><span class="s2">"false"</span>
                   <span class="nv">maxHttpHeaderSize</span><span class="o">=</span><span class="s2">"8192"</span> <span class="nv">protocol</span><span class="o">=</span><span class="s2">"HTTP/1.1"</span> <span class="nv">useBodyEncodingForURI</span><span class="o">=</span><span class="s2">"true"</span> <span class="nv">redirectPort</span><span class="o">=</span><span class="s2">"8443"</span>
                   <span class="nv">acceptCount</span><span class="o">=</span><span class="s2">"100"</span> <span class="nv">disableUploadTimeout</span><span class="o">=</span><span class="s2">"true"</span> <span class="nv">bindOnInit</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">proxyName</span><span class="o">=</span><span class="s2">"jira.treesir.pub"</span> <span class="nv">proxyPort</span><span class="o">=</span><span class="s2">"80"</span>/&gt;
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>添加 <code>proxyName</code> &amp; <code>proxyPort</code> 参数后, 重启服务。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">service jira stop <span class="se">\
</span><span class="se"></span><span class="o">&amp;&amp;</span> service jira start
</code></pre></td></tr></table>
</div>
</div></blockquote>
<p><strong>Nginx 添加虚拟机主机</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash">cat /etc/nginx/conf.d/jira.conf 
server <span class="o">{</span>
    listen 80<span class="p">;</span>
    server_name jira.treesir.pub<span class="p">;</span>
    location / <span class="o">{</span>
        proxy_set_header X-Forwarded-Host <span class="nv">$host</span><span class="p">;</span>
        proxy_set_header X-Forwarded-Server <span class="nv">$host</span><span class="p">;</span>
        proxy_set_header Host <span class="nv">$host</span>:<span class="nv">$server_port</span><span class="p">;</span>
        proxy_set_header X-Forwarded-For <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span> 
        proxy_pass http://192.168.5.188:8080<span class="p">;</span>
        client_max_body_size 0<span class="p">;</span>
    <span class="o">}</span>
<span class="o">}</span>

nginx -t 
  nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
  nginx: configuration file /etc/nginx/nginx.conf <span class="nb">test</span> is successful     <span class="c1"># 检查配置文件</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>192.168.5.188:8080</code> 为你 Jira 的地址，不要配置 <code>127.0.0.1:8080</code> 这样好像会报错。</p>
</blockquote>
</div>
<div class="post-copyright">
<p class="copyright-item">
<span class="item-title">文章作者</span>
<span class="item-content">Johny</span>
</p>
<p class="copyright-item">
<span class="item-title">上次更新</span>
<span class="item-content">
        2021-02-21
        
    </span>
</p>
<p class="copyright-item">
<span class="item-title">许可协议</span>
<span class="item-content"><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" rel="license noopener" target="_blank">CC BY-NC-ND 4.0</a></span>
</p>
</div>
<footer class="post-footer">
<div class="post-tags">
<a href="/tags/jira/">jira</a>
<a href="/tags/install/">install</a>
<a href="/tags/confluence/">confluence</a>
</div>
<nav class="post-nav">
<a class="prev" href="/post/raid-megacli/">
<i class="iconfont icon-left"></i>
<span class="prev-text nav-default">Raid 阵列卡 Megacli 管理工具的使用记录</span>
<span class="prev-text nav-mobile">上一篇</span>
</a>
<a class="next" href="/post/esxi-clone-hosts/">
<span class="next-text nav-default">VMware ESXi Clone 复制虚拟机</span>
<span class="next-text nav-mobile">下一篇</span>
<i class="iconfont icon-right"></i>
</a>
</nav>
</footer>
</article>
</div>
<div id="vcomments"></div>
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage@3/dist/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script>
<script type="text/javascript">
    new Valine({
        el: '#vcomments' ,
        appId: 'wS5tU9o2RILlBpQiEfIDgPwI-gzGzoHsz',
        appKey: 'siSAWI3rzA6Ow8Tmiv7V4GO4',
        notify:  true ,
        verify:  true ,
        avatar:'',
        placeholder: '来留下点什么吧~',
        visitor:  false 
    });
  </script>
</div>
</main>
<footer class="footer" id="footer">
<div class="social-links">
<a class="iconfont icon-email" href="mailto:yangzun@treesir.pub" title="email"></a>
<a class="iconfont icon-github" href="https://github.com/cdryzun" title="github"></a>
<a class="iconfont icon-rss" href="https://cdryzun.github.io/index.xml" title="rss" type="application/rss+xml"></a>
</div>
<div class="copyright">
<span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
</span>
<span class="division">|</span>
<span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
</span>
<span class="copyright-year">
<a class="busuanzi-footer" href="https://beian.miit.gov.cn/">湘ICP备2021002157号-1</a> <img alt="upai" class="ls-is-cached lazyloaded" height="28" src="https://cdn.treesir.pub/img/icp.png" style="margin: -25px 2px" width="23"/> <a href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral" rel="nofollow" target="_blank"><img alt="upai" class="ls-is-cached lazyloaded" height="28" src="https://cdn.treesir.pub/img/upyun.png" style="margin: -25px 2px" width="56"/></a>
    © 
    2019 - 
    2023<span class="heart"><i class="iconfont icon-heart"></i></span><span>Johny </span>
</span>
</div>
</footer>
<div class="back-to-top" id="back-to-top">
<i class="iconfont icon-up"></i>
</div>
</div>
<script crossorigin="anonymous" src="https://cdn.treesir.pub/blog-js/jquery.min.js"></script>
<script crossorigin="anonymous" src="https://cdn.treesir.pub/blog-js/slideout.min.js"></script>
<script crossorigin="anonymous" src="https://cdn.treesir.pub/blog-js/jquery.fancybox.min.js"></script>
<script src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js" type="text/javascript"></script>
<script src="/js/copy-to-clipboard.js"></script>
<script src="https://cdn.treesir.pub/blog-js/docsearch.min.js"></script>
<script>
    docsearch({
    apiKey: "17388eec628e676a77d6235068b458df",
    indexName: "blog",
    appId: "KEECS2XKBV",
    inputSelector: '.docsearch-input',
    debug: false,
    });
</script>
</body>
</html>
